# Story 1.5: Configuration System Integration

## Story Information
- **Epic:** 1 - OCR Jersey Reading Integration
- **Story Number:** 1.5
- **Status:** Draft
- **Priority:** Medium
- **Estimated Effort:** 2-3 hours

## Story Statement
As a **developer**,
I want **to extend the configuration system with OCR parameters**,
so that **OCR behavior can be configured without code changes**.

## Acceptance Criteria
1. Add OCR configuration section to `config_netball.json`
2. Include confidence thresholds, processing parameters
3. Add OCR enable/disable toggle
4. Maintain existing configuration validation
5. Update configuration loading in existing modules

## Integration Verification
- IV1: Existing configuration system remains functional
- IV2: New OCR parameters integrate with existing config loading
- IV3: Configuration changes take effect without system restart

## Dev Notes

### Previous Story Insights
Story 1.4 created the JerseyNumberTracker system for temporal tracking. This story extends the existing configuration system to support OCR parameters, enabling configurable behavior for jersey recognition without requiring code changes.

### Data Models
Based on existing project structure analysis:
- **Existing config_netball.json**: Contains detection, tracking, possession, court, game_rules, categories, zones, standings, models, output, analysis sections
- **New OCR Configuration Section**: Add OCR-specific parameters
  - ocr_enabled: bool - Enable/disable OCR functionality
  - confidence_threshold: float - Minimum confidence for jersey recognition
  - processing_params: dict - OCR processing parameters
  - jersey_number_range: tuple - Valid jersey number range (1-99)
  - temporal_tracking: dict - Jersey tracking parameters

### API Specifications
- **Configuration Loading**: Extend existing config loading to include OCR parameters
- **Parameter Validation**: Add validation for OCR configuration values
- **Default Values**: Provide sensible defaults for OCR parameters
- **Configuration Access**: Add methods for accessing OCR configuration

### Component Specifications
- **Configuration Extension**: Add OCR section to existing config_netball.json
- **Parameter Validation**: Validate OCR parameter ranges and types
- **Default Configuration**: Provide default OCR configuration values
- **Configuration Loading**: Extend existing config loading mechanism
- **Error Handling**: Handle invalid OCR configuration gracefully

### File Locations
Based on existing project structure:
- **Primary file**: `configs/config_netball.json` - Add OCR configuration section
- **Integration**: `core/io_utils.py` - Extend configuration loading
- **Usage**: OCR modules will access configuration through existing system

### Testing Requirements
- Unit tests for OCR configuration loading
- Integration tests with existing configuration system
- Validation tests for OCR parameter ranges
- Default configuration tests
- Error handling tests for invalid configuration

### Technical Constraints
- Must maintain existing configuration system structure
- OCR parameters must be optional (system works without them)
- Configuration validation must be consistent with existing patterns
- Must integrate with existing configuration loading mechanism
- Default values must be sensible for jersey recognition

## Tasks / Subtasks

### Task 1: Add OCR Configuration Section (AC: 1, 2)
1. Add OCR section to `configs/config_netball.json`
2. Include confidence thresholds and processing parameters
3. Add OCR enable/disable toggle
4. Add jersey number range validation
5. Add temporal tracking parameters

### Task 2: Extend Configuration Loading (AC: 4, 5)
1. Update configuration loading in `core/io_utils.py`
2. Add OCR parameter loading logic
3. Add default value handling for OCR parameters
4. Maintain existing configuration validation
5. Add error handling for missing OCR config

### Task 3: Add Parameter Validation (AC: 4)
1. Add validation for OCR confidence thresholds (0.0-1.0)
2. Add validation for jersey number ranges (1-99)
3. Add validation for processing parameters
4. Add validation for temporal tracking parameters
5. Add error handling for invalid parameters

### Task 4: Add Default Configuration (AC: 2, 4)
1. Provide sensible default values for OCR parameters
2. Ensure system works with default configuration
3. Document default configuration values
4. Add fallback behavior for missing parameters
5. Test default configuration functionality

### Task 5: Update Configuration Access (AC: 5)
1. Add methods for accessing OCR configuration
2. Ensure configuration changes take effect
3. Add configuration reloading capability
4. Update existing modules to use OCR configuration
5. Add configuration documentation

### Task 6: Testing and Validation (AC: 1-5, IV1-IV3)
1. Create unit tests for OCR configuration loading
2. Test integration with existing configuration system
3. Test parameter validation
4. Test default configuration behavior
5. Verify configuration changes take effect without restart

## Testing Strategy
- **Unit Tests**: OCR configuration loading, parameter validation, default values
- **Integration Tests**: Configuration system integration, existing functionality
- **Validation Tests**: Parameter range validation, error handling
- **Default Tests**: Default configuration behavior
- **Regression Tests**: Existing configuration functionality

## Definition of Done
- [ ] OCR configuration section added to config_netball.json
- [ ] Confidence thresholds and processing parameters included
- [ ] OCR enable/disable toggle implemented
- [ ] Existing configuration validation maintained
- [ ] Configuration loading updated in existing modules
- [ ] Parameter validation implemented
- [ ] Default configuration values provided
- [ ] All tests passing
- [ ] Documentation updated

## Risk Mitigation
- **Risk**: Breaking existing configuration system
- **Mitigation**: Maintain existing configuration structure, thorough testing
- **Risk**: Invalid OCR configuration causing errors
- **Mitigation**: Comprehensive parameter validation and error handling
- **Risk**: Configuration changes not taking effect
- **Mitigation**: Proper configuration reloading and access methods

## Dependencies
- **Requires**: Story 1.4 (Jersey Number Tracking System) to be complete
- **Enables**: Story 1.6 (Detection Pipeline Integration), Story 1.8 (Web Interface Enhancement)

## Dev Agent Record
- **Agent Model Used:** TBD
- **Debug Log References:** TBD
- **Completion Notes:** TBD
- **File List:** TBD
- **Change Log:** TBD




